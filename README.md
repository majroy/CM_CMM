# CM_CMM - CMM methodology for contour method measurements
This collection of scripts/functions permits one to automate Coordinate Measurement Machine (CMM) programming for 'hen-peck' style measurements via MATLAB.

Simple outlines and those which contain self-restraint features are included. Documentation is included herein, as well as demonstration outlines. Input is a series of `.txt` files comprising the outline/restraint features, and the output is either:
* An `*.agw` file which has *pure* DMIS syntax. These output files can be directly interpreted by Mitutoyo CMMs with the ASCII MCOSMOS interpreter installed. Other packages that might be able to read this include Camio (LK-DMIS), Open DMIS, Virtual DMIS, etc. This is a complete program that contains file locations for results, file writing intervals and intermediate points.
* A `*.csv` file that can be imported into *non*-DMIS packages such as (confusingly) PC-DMIS, MCOSMOS, Calypso etc. Note that a complete programme will need to be created such as probe selection, intermediate points and so on. The file will contain an appropriate header along with labels according to:

|TYPE	|NAME	|X			|Y		|Z		|I	|J	|K|
|--- |---|---|---|---|---|---|---|
|POINT	|PNT1	|0.092801	|-48.491|1.5185	|0	|0	|1|
|POINT	|PNT2	|0.095155	|-43.346|1.5185	|0	|0	|1|
|POINT	|PNT3	|0.097489	|-53.637|1.5185	|0	|0	|1|
|POINT	|PNTn	|...		|...	|...	|0	|0	|1|


Specifying either an *agw or *csv file is accomplished via setting a variable true or false in MeasMesh.m

# Quick start
To get started, read the documentation and experiment with the main scripts, `OutlineGen.m` and `MeasMesh.m`. These have been pre-populated with demonstration outlines included in the repository.

Note that very large numbers of points, *e.g.* ~10,000, will take a long time to run; it is also recommended to install the full DistMesh code available here: http://persson.berkeley.edu/distmesh/

# Thanks
A big thank you goes out to Per-Olof Persson for writing [Distmesh](http://persson.berkeley.edu/distmesh/) and Angus Johnson for the  [Clipper Library](http://www.angusj.com/delphi/clipper.php) for some really great polygon tools.

# Disclaimer & Warning
Review all code generated by this software manually prior to running on a physical system. Perform initial dry runs to avoid crashes & damage to your CMM. Use at your own risk.
